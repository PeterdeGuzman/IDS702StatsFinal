<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Peter de Guzman">

<title>peter_models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="peter_models_files/libs/clipboard/clipboard.min.js"></script>
<script src="peter_models_files/libs/quarto-html/quarto.js"></script>
<script src="peter_models_files/libs/quarto-html/popper.min.js"></script>
<script src="peter_models_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="peter_models_files/libs/quarto-html/anchor.min.js"></script>
<link href="peter_models_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="peter_models_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="peter_models_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="peter_models_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="peter_models_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">peter_models</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Peter de Guzman </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
</section>
<section id="loading-packages" class="level1">
<h1>Loading Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ordinal'

The following object is masked from 'package:dplyr':

    slice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData

Attaching package: 'car'

The following object is masked from 'package:dplyr':

    recode

The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brant)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
</div>
</section>
<section id="loading-data" class="level1">
<h1>Loading data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"/Users/pdeguz01/Documents/git/Data/2020 CMPS/Output/2020cmps_clean.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="running-chi-square-tests" class="level1">
<h1>Running chi-square tests</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create a summary table for all categorical variables</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># variables &lt;- c("Q29", "Q271", "S2_RACE_PRIME", "S3", "S3B", "S5_AGE", "S13", "S14", "S7", "Q21", "S2_M", "Q627", "Q628", "Q629R1", "Religion", "educ", "sex_orientation", "rural", "white", "race_recoded", "age_recoded")</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># # Chi-square tests for each variable</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># chi_square_results &lt;- lapply(variables, function(var) {</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   chisq.test(table(dataset_clean[[var]], dataset_clean$Q29))</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># })</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print chi-square results</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># names(chi_square_results) &lt;- variables</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print(chi_square_results)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Variable</th>
<th>Chi-Sq Test Statistic</th>
<th>Degrees of Freedom (df)</th>
<th>p-value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Q271</td>
<td>291.49</td>
<td>12</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td>S2_RACE_PRIME</td>
<td>291.12</td>
<td>21</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="odd">
<td>S3</td>
<td>101.7</td>
<td>15</td>
<td>6.196e-15</td>
</tr>
<tr class="even">
<td>S3B</td>
<td>296.35</td>
<td>9</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="odd">
<td>S5_AGE</td>
<td>NaN</td>
<td>18</td>
<td>NA</td>
</tr>
<tr class="even">
<td>S13</td>
<td>710.69</td>
<td>18</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="odd">
<td>S14</td>
<td>196.79</td>
<td>12</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td>S7</td>
<td>148.62</td>
<td>6</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="odd">
<td>Q21</td>
<td>1284.1</td>
<td>9</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td>S2_M</td>
<td>6.0327</td>
<td>3</td>
<td>0.11</td>
</tr>
<tr class="odd">
<td>Q627</td>
<td>246.82</td>
<td>3</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td>Q628</td>
<td>9.0318</td>
<td>6</td>
<td>0.1718</td>
</tr>
<tr class="odd">
<td>Q629R1</td>
<td>6.9533</td>
<td>3</td>
<td>0.0734</td>
</tr>
<tr class="even">
<td>Religion</td>
<td>562.39</td>
<td>45</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="odd">
<td>educ</td>
<td>608.65</td>
<td>6</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td>sex_orientation</td>
<td>55.679</td>
<td>6</td>
<td>3.379e-10</td>
</tr>
<tr class="odd">
<td>rural/urban&amp;suburban</td>
<td>83.719</td>
<td>3</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td>white/non-white</td>
<td>75.137</td>
<td>3</td>
<td>3.386e-16</td>
</tr>
<tr class="odd">
<td>race_recoded</td>
<td>276.36</td>
<td>18</td>
<td>&lt; 2.2e-16</td>
</tr>
<tr class="even">
<td>age_recoded</td>
<td>396.97</td>
<td>15</td>
<td>&lt; 2.2e-16</td>
</tr>
</tbody>
</table>
<section id="takeaways-from-chi-square-test" class="level2">
<h2 class="anchored" data-anchor-id="takeaways-from-chi-square-test">Takeaways from Chi-Square Test</h2>
<p>Our outcome variable is Q29 (interest in politics).</p>
<p>There appears to be a significant relationship between the following variables and Q29 (interest in politics):</p>
<ul>
<li><p>Age (Recoded)</p></li>
<li><p>Race (Recoded)</p></li>
<li><p>Gender</p></li>
<li><p>White or Non-White status</p></li>
<li><p>Rural or Urban &amp; Suburban status</p></li>
<li><p>Sexual Orientation</p></li>
<li><p>Religion</p></li>
<li><p>Educational Attainment</p></li>
<li><p>Having experienced prior discrimination (Q627)</p></li>
<li><p>Political Party ID</p></li>
<li><p>Nativity (born in US or other)</p></li>
</ul>
</section>
</section>
<section id="fitting-olr-model-using-polr" class="level1">
<h1>Fitting OLR Model Using polr()</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># package for model</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># package for confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dataset_clean<span class="sc">$</span>Q29_reordered  <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset_clean<span class="sc">$</span>Q29,</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"(4) Not at all interested in politics"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(3) Not that interested in politics"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(2) Somewhat interested"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(1) Very interested in politics"</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>dataset_clean<span class="sc">$</span>Q271_reordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset_clean<span class="sc">$</span>Q271,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"(5) Not at all important"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(4) Slightly important"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(3) Moderately important"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(2) Very important"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(1) Extremely important"</span>))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>ord_mod <span class="ot">&lt;-</span> <span class="fu">polr</span>(Q29 <span class="sc">~</span> Q271_reordered <span class="sc">+</span> race_recoded <span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                  age_recoded <span class="sc">+</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>            educ <span class="sc">+</span>  <span class="co"># Educational Attainment</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>            S3B <span class="sc">+</span> <span class="co"># Gender</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            Q21, <span class="co"># Party affiliation</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> dataset_clean, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ord_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = Q29 ~ Q271_reordered + race_recoded + age_recoded + 
    educ + S3B + Q21, data = dataset_clean, Hess = TRUE)

Coefficients:
                                          Value Std. Error  t value
Q271_reordered(4) Slightly important    0.04742    0.06170   0.7685
Q271_reordered(3) Moderately important  0.05505    0.05153   1.0684
Q271_reordered(2) Very important       -0.16304    0.05217  -3.1249
Q271_reordered(1) Extremely important  -0.37257    0.05191  -7.1772
race_recodedBlack                       0.14429    0.04749   3.0381
race_recodedAsian American              0.52356    0.04712  11.1100
race_recodedLatino                      0.23523    0.04784   4.9169
race_recodedAIAN                        0.40211    0.07910   5.0837
race_recodedNHPI                        0.57672    0.10296   5.6016
race_recodedArab/MENA                  -0.14942    0.12974  -1.1517
age_recoded30-39                       -0.03434    0.04352  -0.7891
age_recoded40-49                        0.07426    0.04731   1.5695
age_recoded50-59                       -0.09668    0.04764  -2.0296
age_recoded60-69                       -0.28317    0.04789  -5.9125
age_recoded70+                         -0.52431    0.05727  -9.1553
educSome college experience            -0.42283    0.04319  -9.7893
educCollege graduate                   -0.80159    0.03831 -20.9228
S3B(2) Woman                            0.54201    0.02913  18.6044
S3B(3) Non-binary                      -0.32081    0.16401  -1.9560
S3B(4) Something else (Specify)        -0.10908    0.33157  -0.3290
Q21(2) Democrat                        -0.12261    0.04100  -2.9904
Q21(3) Independent                      0.54363    0.04290  12.6734
Q21(4) Other party                      1.54529    0.07772  19.8822

Intercepts:
                                                                          Value   
(1) Very interested in politics|(2) Somewhat interested                    -1.3189
(2) Somewhat interested|(3) Not that interested in politics                 0.7323
(3) Not that interested in politics|(4) Not at all interested in politics   2.1573
                                                                          Std. Error
(1) Very interested in politics|(2) Somewhat interested                     0.0632  
(2) Somewhat interested|(3) Not that interested in politics                 0.0627  
(3) Not that interested in politics|(4) Not at all interested in politics   0.0651  
                                                                          t value 
(1) Very interested in politics|(2) Somewhat interested                   -20.8716
(2) Somewhat interested|(3) Not that interested in politics                11.6827
(3) Not that interested in politics|(4) Not at all interested in politics  33.1238

Residual Deviance: 42630.76 
AIC: 42682.76 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(<span class="fu">summary</span>(ord_mod)<span class="sc">$</span>coef[,<span class="st">"t value"</span>]))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ctable <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">summary</span>(ord_mod)<span class="sc">$</span>coef,pvals)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>ctable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                Value
Q271_reordered(4) Slightly important                                       0.04741685
Q271_reordered(3) Moderately important                                     0.05505139
Q271_reordered(2) Very important                                          -0.16303731
Q271_reordered(1) Extremely important                                     -0.37257037
race_recodedBlack                                                          0.14428759
race_recodedAsian American                                                 0.52355690
race_recodedLatino                                                         0.23522542
race_recodedAIAN                                                           0.40211409
race_recodedNHPI                                                           0.57672373
race_recodedArab/MENA                                                     -0.14942114
age_recoded30-39                                                          -0.03434261
age_recoded40-49                                                           0.07425899
age_recoded50-59                                                          -0.09668095
age_recoded60-69                                                          -0.28317441
age_recoded70+                                                            -0.52430892
educSome college experience                                               -0.42283179
educCollege graduate                                                      -0.80158846
S3B(2) Woman                                                               0.54201345
S3B(3) Non-binary                                                         -0.32080696
S3B(4) Something else (Specify)                                           -0.10907993
Q21(2) Democrat                                                           -0.12261032
Q21(3) Independent                                                         0.54363184
Q21(4) Other party                                                         1.54528785
(1) Very interested in politics|(2) Somewhat interested                   -1.31894215
(2) Somewhat interested|(3) Not that interested in politics                0.73226509
(3) Not that interested in politics|(4) Not at all interested in politics  2.15726285
                                                                          Std. Error
Q271_reordered(4) Slightly important                                      0.06169912
Q271_reordered(3) Moderately important                                    0.05152527
Q271_reordered(2) Very important                                          0.05217434
Q271_reordered(1) Extremely important                                     0.05190997
race_recodedBlack                                                         0.04749281
race_recodedAsian American                                                0.04712485
race_recodedLatino                                                        0.04783999
race_recodedAIAN                                                          0.07909920
race_recodedNHPI                                                          0.10295772
race_recodedArab/MENA                                                     0.12974449
age_recoded30-39                                                          0.04352058
age_recoded40-49                                                          0.04731448
age_recoded50-59                                                          0.04763632
age_recoded60-69                                                          0.04789428
age_recoded70+                                                            0.05726808
educSome college experience                                               0.04319321
educCollege graduate                                                      0.03831166
S3B(2) Woman                                                              0.02913356
S3B(3) Non-binary                                                         0.16401092
S3B(4) Something else (Specify)                                           0.33156609
Q21(2) Democrat                                                           0.04100182
Q21(3) Independent                                                        0.04289563
Q21(4) Other party                                                        0.07772233
(1) Very interested in politics|(2) Somewhat interested                   0.06319317
(2) Somewhat interested|(3) Not that interested in politics               0.06267924
(3) Not that interested in politics|(4) Not at all interested in politics 0.06512729
                                                                              t value
Q271_reordered(4) Slightly important                                        0.7685175
Q271_reordered(3) Moderately important                                      1.0684348
Q271_reordered(2) Very important                                           -3.1248561
Q271_reordered(1) Extremely important                                      -7.1772404
race_recodedBlack                                                           3.0380934
race_recodedAsian American                                                 11.1099957
race_recodedLatino                                                          4.9169209
race_recodedAIAN                                                            5.0836684
race_recodedNHPI                                                            5.6015590
race_recodedArab/MENA                                                      -1.1516569
age_recoded30-39                                                           -0.7891120
age_recoded40-49                                                            1.5694772
age_recoded50-59                                                           -2.0295636
age_recoded60-69                                                           -5.9124890
age_recoded70+                                                             -9.1553439
educSome college experience                                                -9.7893115
educCollege graduate                                                      -20.9228330
S3B(2) Woman                                                               18.6044357
S3B(3) Non-binary                                                          -1.9560098
S3B(4) Something else (Specify)                                            -0.3289840
Q21(2) Democrat                                                            -2.9903631
Q21(3) Independent                                                         12.6733618
Q21(4) Other party                                                         19.8821619
(1) Very interested in politics|(2) Somewhat interested                   -20.8715932
(2) Somewhat interested|(3) Not that interested in politics                11.6827369
(3) Not that interested in politics|(4) Not at all interested in politics  33.1237918
                                                                                  pvals
Q271_reordered(4) Slightly important                                       4.421798e-01
Q271_reordered(3) Moderately important                                     2.853244e-01
Q271_reordered(2) Very important                                           1.778921e-03
Q271_reordered(1) Extremely important                                      7.113256e-13
race_recodedBlack                                                          2.380802e-03
race_recodedAsian American                                                 1.121649e-28
race_recodedLatino                                                         8.791607e-07
race_recodedAIAN                                                           3.702140e-07
race_recodedNHPI                                                           2.124325e-08
race_recodedArab/MENA                                                      2.494621e-01
age_recoded30-39                                                           4.300465e-01
age_recoded40-49                                                           1.165368e-01
age_recoded50-59                                                           4.240091e-02
age_recoded60-69                                                           3.369763e-09
age_recoded70+                                                             5.418495e-20
educSome college experience                                                1.251452e-22
educCollege graduate                                                       3.318056e-97
S3B(2) Woman                                                               2.957896e-77
S3B(3) Non-binary                                                          5.046400e-02
S3B(4) Something else (Specify)                                            7.421678e-01
Q21(2) Democrat                                                            2.786460e-03
Q21(3) Independent                                                         8.307615e-37
Q21(4) Other party                                                         5.807672e-88
(1) Very interested in politics|(2) Somewhat interested                    9.704501e-97
(2) Somewhat interested|(3) Not that interested in politics                1.561844e-31
(3) Not that interested in politics|(4) Not at all interested in politics 1.350775e-240</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(exp_coefs <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR=</span><span class="fu">coef</span>(ord_mod),<span class="fu">confint</span>(ord_mod))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                              OR     2.5 %    97.5 %
Q271_reordered(4) Slightly important   1.0485590 0.9291831 1.1834322
Q271_reordered(3) Moderately important 1.0565949 0.9552164 1.1690188
Q271_reordered(2) Very important       0.8495595 0.7670392 0.9411139
Q271_reordered(1) Extremely important  0.6889612 0.6223323 0.7627768
race_recodedBlack                      1.1552163 1.0525289 1.2679092
race_recodedAsian American             1.6880211 1.5391862 1.8513639
race_recodedLatino                     1.2651939 1.1519363 1.3895473
race_recodedAIAN                       1.4949819 1.2805626 1.7456495
race_recodedNHPI                       1.7801965 1.4547141 2.1778633
race_recodedArab/MENA                  0.8612064 0.6674616 1.1100158
age_recoded30-39                       0.9662404 0.8872390 1.0522818
age_recoded40-49                       1.0770857 0.9817057 1.1817667
age_recoded50-59                       0.9078456 0.8268989 0.9966590
age_recoded60-69                       0.7533884 0.6858720 0.8275261
age_recoded70+                         0.5919643 0.5290585 0.6622219
educSome college experience            0.6551888 0.6019761 0.7130418
educCollege graduate                   0.4486158 0.4161212 0.4835526
S3B(2) Woman                           1.7194654 1.6241016 1.8205853
S3B(3) Non-binary                      0.7255633 0.5256959 1.0000813
S3B(4) Something else (Specify)        0.8966587 0.4671477 1.7194788
Q21(2) Democrat                        0.8846083 0.8163087 0.9586461
Q21(3) Independent                     1.7222505 1.5835279 1.8734981
Q21(4) Other party                     4.6893213 4.0284320 5.4625035</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ord_mod<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (1) Very interested in politics (2) Somewhat interested
1                      0.02645285               0.1480024
2                      0.16780875               0.4428233
3                      0.32612354               0.4639613
4                      0.38534278               0.4444664
5                      0.40282736               0.4370760
6                      0.14492905               0.4237018
  (3) Not that interested in politics (4) Not at all interested in politics
1                           0.2932454                            0.53229932
2                           0.2564000                            0.13296797
3                           0.1498531                            0.06006212
4                           0.1231821                            0.04700868
5                           0.1162620                            0.04383463
6                           0.2770690                            0.15430014</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(ord_mod))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] (4) Not at all interested in politics (2) Somewhat interested              
[3] (2) Somewhat interested               (2) Somewhat interested              
[5] (2) Somewhat interested               (2) Somewhat interested              
4 Levels: (1) Very interested in politics ... (4) Not at all interested in politics</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(ord_mod), dataset_clean<span class="sc">$</span>Q29, <span class="at">mode=</span><span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                                       Reference
Prediction                              (1) Very interested in politics
  (1) Very interested in politics                                   644
  (2) Somewhat interested                                          3577
  (3) Not that interested in politics                                53
  (4) Not at all interested in politics                              32
                                       Reference
Prediction                              (2) Somewhat interested
  (1) Very interested in politics                           528
  (2) Somewhat interested                                  6794
  (3) Not that interested in politics                       197
  (4) Not at all interested in politics                      93
                                       Reference
Prediction                              (3) Not that interested in politics
  (1) Very interested in politics                                       127
  (2) Somewhat interested                                              3199
  (3) Not that interested in politics                                   198
  (4) Not at all interested in politics                                 119
                                       Reference
Prediction                              (4) Not at all interested in politics
  (1) Very interested in politics                                          31
  (2) Somewhat interested                                                1543
  (3) Not that interested in politics                                     193
  (4) Not at all interested in politics                                   217

Overall Statistics
                                         
               Accuracy : 0.4476         
                 95% CI : (0.4402, 0.455)
    No Information Rate : 0.4339         
    P-Value [Acc &gt; NIR] : 0.0001263      
                                         
                  Kappa : 0.0749         
                                         
 Mcnemar's Test P-Value : &lt; 2.2e-16      

Statistics by Class:

                     Class: (1) Very interested in politics
Sensitivity                                         0.14956
Specificity                                         0.94818
Pos Pred Value                                      0.48421
Neg Pred Value                                      0.77416
Precision                                           0.48421
Recall                                              0.14956
F1                                                  0.22853
Prevalence                                          0.24543
Detection Rate                                      0.03671
Detection Prevalence                                0.07581
Balanced Accuracy                                   0.54887
                     Class: (2) Somewhat interested
Sensitivity                                  0.8925
Specificity                                  0.1625
Pos Pred Value                               0.4495
Neg Pred Value                               0.6637
Precision                                    0.4495
Recall                                       0.8925
F1                                           0.5979
Prevalence                                   0.4339
Detection Rate                               0.3872
Detection Prevalence                         0.8614
Balanced Accuracy                            0.5275
                     Class: (3) Not that interested in politics
Sensitivity                                             0.05435
Specificity                                             0.96813
Pos Pred Value                                          0.30889
Neg Pred Value                                          0.79620
Precision                                               0.30889
Recall                                                  0.05435
F1                                                      0.09244
Prevalence                                              0.20764
Detection Rate                                          0.01129
Detection Prevalence                                    0.03653
Balanced Accuracy                                       0.51124
                     Class: (4) Not at all interested in politics
Sensitivity                                               0.10938
Specificity                                               0.98432
Pos Pred Value                                            0.47072
Neg Pred Value                                            0.89657
Precision                                                 0.47072
Recall                                                    0.10938
F1                                                        0.17751
Prevalence                                                0.11308
Detection Rate                                            0.01237
Detection Prevalence                                      0.02628
Balanced Accuracy                                         0.54685</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate predictions for the ordinal model</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new_dataset &lt;- data.frame</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># predict(ord_mod, new_dataset)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fitting-olr-with-interaction-terms" class="level1">
<h1>Fitting OLR with interaction terms</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># package for model</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># package for confusion matrix</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>dataset_clean<span class="sc">$</span>Q271_reordered <span class="ot">&lt;-</span> <span class="fu">factor</span>(dataset_clean<span class="sc">$</span>Q271,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"(5) Not at all important"</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(4) Slightly important"</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(3) Moderately important"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(2) Very important"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"(1) Extremely important"</span>))</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>ord_mod_interactions <span class="ot">&lt;-</span> <span class="fu">polr</span>(Q29 <span class="sc">~</span> Q271_reordered <span class="sc">*</span> S3B <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                               race_recoded <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>                  age_recoded <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>            educ <span class="sc">+</span>  <span class="co"># Educational Attainment</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>            Q21, <span class="co"># Party affiliation</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> dataset_clean, <span class="at">Hess=</span><span class="cn">TRUE</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ord_mod_interactions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = Q29 ~ Q271_reordered * S3B + race_recoded + age_recoded + 
    educ + Q21, data = dataset_clean, Hess = TRUE)

Coefficients:
                                                                           Value
Q271_reordered(4) Slightly important                                    0.033317
Q271_reordered(3) Moderately important                                  0.022567
Q271_reordered(2) Very important                                       -0.178318
Q271_reordered(1) Extremely important                                  -0.499294
S3B(2) Woman                                                            0.462954
S3B(3) Non-binary                                                      -0.619752
S3B(4) Something else (Specify)                                        -0.766014
race_recodedBlack                                                       0.141944
race_recodedAsian American                                              0.519935
race_recodedLatino                                                      0.229832
race_recodedAIAN                                                        0.397617
race_recodedNHPI                                                        0.578789
race_recodedArab/MENA                                                  -0.147511
age_recoded30-39                                                       -0.030606
age_recoded40-49                                                        0.078236
age_recoded50-59                                                       -0.093440
age_recoded60-69                                                       -0.280565
age_recoded70+                                                         -0.524513
educSome college experience                                            -0.422967
educCollege graduate                                                   -0.803693
Q21(2) Democrat                                                        -0.125161
Q21(3) Independent                                                      0.543610
Q21(4) Other party                                                      1.547636
Q271_reordered(4) Slightly important:S3B(2) Woman                       0.004428
Q271_reordered(3) Moderately important:S3B(2) Woman                     0.055399
Q271_reordered(2) Very important:S3B(2) Woman                           0.021044
Q271_reordered(1) Extremely important:S3B(2) Woman                      0.209009
Q271_reordered(4) Slightly important:S3B(3) Non-binary                  0.431374
Q271_reordered(3) Moderately important:S3B(3) Non-binary                0.421733
Q271_reordered(2) Very important:S3B(3) Non-binary                      0.665995
Q271_reordered(1) Extremely important:S3B(3) Non-binary                 0.131784
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)    1.484451
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify) -0.531151
Q271_reordered(2) Very important:S3B(4) Something else (Specify)        2.263274
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)   0.427094
                                                                       Std. Error
Q271_reordered(4) Slightly important                                      0.08940
Q271_reordered(3) Moderately important                                    0.07406
Q271_reordered(2) Very important                                          0.07440
Q271_reordered(1) Extremely important                                     0.07451
S3B(2) Woman                                                              0.07816
S3B(3) Non-binary                                                         0.31541
S3B(4) Something else (Specify)                                           0.89295
race_recodedBlack                                                         0.04759
race_recodedAsian American                                                0.04724
race_recodedLatino                                                        0.04799
race_recodedAIAN                                                          0.07927
race_recodedNHPI                                                          0.10300
race_recodedArab/MENA                                                     0.12987
age_recoded30-39                                                          0.04357
age_recoded40-49                                                          0.04736
age_recoded50-59                                                          0.04767
age_recoded60-69                                                          0.04792
age_recoded70+                                                            0.05732
educSome college experience                                               0.04321
educCollege graduate                                                      0.03833
Q21(2) Democrat                                                           0.04103
Q21(3) Independent                                                        0.04291
Q21(4) Other party                                                        0.07773
Q271_reordered(4) Slightly important:S3B(2) Woman                         0.12279
Q271_reordered(3) Moderately important:S3B(2) Woman                       0.09848
Q271_reordered(2) Very important:S3B(2) Woman                             0.09634
Q271_reordered(1) Extremely important:S3B(2) Woman                        0.09444
Q271_reordered(4) Slightly important:S3B(3) Non-binary                    0.60486
Q271_reordered(3) Moderately important:S3B(3) Non-binary                  0.49295
Q271_reordered(2) Very important:S3B(3) Non-binary                        0.46865
Q271_reordered(1) Extremely important:S3B(3) Non-binary                   0.46307
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)      1.12071
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify)    1.23573
Q271_reordered(2) Very important:S3B(4) Something else (Specify)          1.36449
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)     1.04147
                                                                         t value
Q271_reordered(4) Slightly important                                     0.37266
Q271_reordered(3) Moderately important                                   0.30470
Q271_reordered(2) Very important                                        -2.39659
Q271_reordered(1) Extremely important                                   -6.70094
S3B(2) Woman                                                             5.92291
S3B(3) Non-binary                                                       -1.96494
S3B(4) Something else (Specify)                                         -0.85785
race_recodedBlack                                                        2.98249
race_recodedAsian American                                              11.00602
race_recodedLatino                                                       4.78915
race_recodedAIAN                                                         5.01569
race_recodedNHPI                                                         5.61909
race_recodedArab/MENA                                                   -1.13588
age_recoded30-39                                                        -0.70251
age_recoded40-49                                                         1.65189
age_recoded50-59                                                        -1.96001
age_recoded60-69                                                        -5.85481
age_recoded70+                                                          -9.14998
educSome college experience                                             -9.78870
educCollege graduate                                                   -20.96885
Q21(2) Democrat                                                         -3.05022
Q21(3) Independent                                                      12.66739
Q21(4) Other party                                                      19.91148
Q271_reordered(4) Slightly important:S3B(2) Woman                        0.03606
Q271_reordered(3) Moderately important:S3B(2) Woman                      0.56256
Q271_reordered(2) Very important:S3B(2) Woman                            0.21844
Q271_reordered(1) Extremely important:S3B(2) Woman                       2.21316
Q271_reordered(4) Slightly important:S3B(3) Non-binary                   0.71318
Q271_reordered(3) Moderately important:S3B(3) Non-binary                 0.85553
Q271_reordered(2) Very important:S3B(3) Non-binary                       1.42108
Q271_reordered(1) Extremely important:S3B(3) Non-binary                  0.28459
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)     1.32456
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify)  -0.42983
Q271_reordered(2) Very important:S3B(4) Something else (Specify)         1.65870
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)    0.41009

Intercepts:
                                                                          Value   
(1) Very interested in politics|(2) Somewhat interested                    -1.3688
(2) Somewhat interested|(3) Not that interested in politics                 0.6840
(3) Not that interested in politics|(4) Not at all interested in politics   2.1094
                                                                          Std. Error
(1) Very interested in politics|(2) Somewhat interested                     0.0754  
(2) Somewhat interested|(3) Not that interested in politics                 0.0749  
(3) Not that interested in politics|(4) Not at all interested in politics   0.0769  
                                                                          t value 
(1) Very interested in politics|(2) Somewhat interested                   -18.1527
(2) Somewhat interested|(3) Not that interested in politics                 9.1350
(3) Not that interested in politics|(4) Not at all interested in politics  27.4268

Residual Deviance: 42612.07 
AIC: 42688.07 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pvals_interact <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fu">abs</span>(<span class="fu">summary</span>(ord_mod_interactions)<span class="sc">$</span>coef[,<span class="st">"t value"</span>]))<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ctable_interact <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">summary</span>(ord_mod_interactions)<span class="sc">$</span>coef,pvals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in cbind(summary(ord_mod_interactions)$coef, pvals): number of rows of
result is not a multiple of vector length (arg 2)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ctable_interact</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                                 Value
Q271_reordered(4) Slightly important                                       0.033316883
Q271_reordered(3) Moderately important                                     0.022566582
Q271_reordered(2) Very important                                          -0.178318295
Q271_reordered(1) Extremely important                                     -0.499294429
S3B(2) Woman                                                               0.462954445
S3B(3) Non-binary                                                         -0.619751594
S3B(4) Something else (Specify)                                           -0.766014402
race_recodedBlack                                                          0.141943783
race_recodedAsian American                                                 0.519935044
race_recodedLatino                                                         0.229832177
race_recodedAIAN                                                           0.397616666
race_recodedNHPI                                                           0.578788725
race_recodedArab/MENA                                                     -0.147511419
age_recoded30-39                                                          -0.030605593
age_recoded40-49                                                           0.078236073
age_recoded50-59                                                          -0.093440336
age_recoded60-69                                                          -0.280565173
age_recoded70+                                                            -0.524513465
educSome college experience                                               -0.422966692
educCollege graduate                                                      -0.803693040
Q21(2) Democrat                                                           -0.125161178
Q21(3) Independent                                                         0.543610195
Q21(4) Other party                                                         1.547636091
Q271_reordered(4) Slightly important:S3B(2) Woman                          0.004428177
Q271_reordered(3) Moderately important:S3B(2) Woman                        0.055399206
Q271_reordered(2) Very important:S3B(2) Woman                              0.021044150
Q271_reordered(1) Extremely important:S3B(2) Woman                         0.209008729
Q271_reordered(4) Slightly important:S3B(3) Non-binary                     0.431373903
Q271_reordered(3) Moderately important:S3B(3) Non-binary                   0.421732585
Q271_reordered(2) Very important:S3B(3) Non-binary                         0.665994959
Q271_reordered(1) Extremely important:S3B(3) Non-binary                    0.131784368
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)       1.484451317
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify)    -0.531151190
Q271_reordered(2) Very important:S3B(4) Something else (Specify)           2.263274194
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)      0.427094393
(1) Very interested in politics|(2) Somewhat interested                   -1.368792818
(2) Somewhat interested|(3) Not that interested in politics                0.684046426
(3) Not that interested in politics|(4) Not at all interested in politics  2.109433396
                                                                          Std. Error
Q271_reordered(4) Slightly important                                      0.08940246
Q271_reordered(3) Moderately important                                    0.07406160
Q271_reordered(2) Very important                                          0.07440495
Q271_reordered(1) Extremely important                                     0.07451115
S3B(2) Woman                                                              0.07816330
S3B(3) Non-binary                                                         0.31540543
S3B(4) Something else (Specify)                                           0.89294664
race_recodedBlack                                                         0.04759230
race_recodedAsian American                                                0.04724096
race_recodedLatino                                                        0.04799019
race_recodedAIAN                                                          0.07927456
race_recodedNHPI                                                          0.10300395
race_recodedArab/MENA                                                     0.12986579
age_recoded30-39                                                          0.04356624
age_recoded40-49                                                          0.04736154
age_recoded50-59                                                          0.04767330
age_recoded60-69                                                          0.04792043
age_recoded70+                                                            0.05732398
educSome college experience                                               0.04320968
educCollege graduate                                                      0.03832795
Q21(2) Democrat                                                           0.04103349
Q21(3) Independent                                                        0.04291414
Q21(4) Other party                                                        0.07772581
Q271_reordered(4) Slightly important:S3B(2) Woman                         0.12278729
Q271_reordered(3) Moderately important:S3B(2) Woman                       0.09847736
Q271_reordered(2) Very important:S3B(2) Woman                             0.09633794
Q271_reordered(1) Extremely important:S3B(2) Woman                        0.09443885
Q271_reordered(4) Slightly important:S3B(3) Non-binary                    0.60486281
Q271_reordered(3) Moderately important:S3B(3) Non-binary                  0.49294769
Q271_reordered(2) Very important:S3B(3) Non-binary                        0.46865387
Q271_reordered(1) Extremely important:S3B(3) Non-binary                   0.46307207
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)      1.12070916
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify)    1.23572559
Q271_reordered(2) Very important:S3B(4) Something else (Specify)          1.36448741
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)     1.04146866
(1) Very interested in politics|(2) Somewhat interested                   0.07540422
(2) Somewhat interested|(3) Not that interested in politics               0.07488218
(3) Not that interested in politics|(4) Not at all interested in politics 0.07691130
                                                                               t value
Q271_reordered(4) Slightly important                                        0.37266181
Q271_reordered(3) Moderately important                                      0.30470017
Q271_reordered(2) Very important                                           -2.39659170
Q271_reordered(1) Extremely important                                      -6.70093577
S3B(2) Woman                                                                5.92291305
S3B(3) Non-binary                                                          -1.96493634
S3B(4) Something else (Specify)                                            -0.85785014
race_recodedBlack                                                           2.98249473
race_recodedAsian American                                                 11.00602126
race_recodedLatino                                                          4.78914932
race_recodedAIAN                                                            5.01569090
race_recodedNHPI                                                            5.61909268
race_recodedArab/MENA                                                      -1.13587592
age_recoded30-39                                                           -0.70250704
age_recoded40-49                                                            1.65189028
age_recoded50-59                                                           -1.96001403
age_recoded60-69                                                           -5.85481364
age_recoded70+                                                             -9.14998265
educSome college experience                                                -9.78870198
educCollege graduate                                                      -20.96885178
Q21(2) Democrat                                                            -3.05021994
Q21(3) Independent                                                         12.66739199
Q21(4) Other party                                                         19.91148239
Q271_reordered(4) Slightly important:S3B(2) Woman                           0.03606381
Q271_reordered(3) Moderately important:S3B(2) Woman                         0.56255779
Q271_reordered(2) Very important:S3B(2) Woman                               0.21844093
Q271_reordered(1) Extremely important:S3B(2) Woman                          2.21316470
Q271_reordered(4) Slightly important:S3B(3) Non-binary                      0.71317644
Q271_reordered(3) Moderately important:S3B(3) Non-binary                    0.85553213
Q271_reordered(2) Very important:S3B(3) Non-binary                          1.42108068
Q271_reordered(1) Extremely important:S3B(3) Non-binary                     0.28458717
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)        1.32456428
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify)     -0.42982940
Q271_reordered(2) Very important:S3B(4) Something else (Specify)            1.65869921
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)       0.41008857
(1) Very interested in politics|(2) Somewhat interested                   -18.15273601
(2) Somewhat interested|(3) Not that interested in politics                 9.13496885
(3) Not that interested in politics|(4) Not at all interested in politics  27.42683290
                                                                                  pvals
Q271_reordered(4) Slightly important                                       4.421798e-01
Q271_reordered(3) Moderately important                                     2.853244e-01
Q271_reordered(2) Very important                                           1.778921e-03
Q271_reordered(1) Extremely important                                      7.113256e-13
S3B(2) Woman                                                               2.380802e-03
S3B(3) Non-binary                                                          1.121649e-28
S3B(4) Something else (Specify)                                            8.791607e-07
race_recodedBlack                                                          3.702140e-07
race_recodedAsian American                                                 2.124325e-08
race_recodedLatino                                                         2.494621e-01
race_recodedAIAN                                                           4.300465e-01
race_recodedNHPI                                                           1.165368e-01
race_recodedArab/MENA                                                      4.240091e-02
age_recoded30-39                                                           3.369763e-09
age_recoded40-49                                                           5.418495e-20
age_recoded50-59                                                           1.251452e-22
age_recoded60-69                                                           3.318056e-97
age_recoded70+                                                             2.957896e-77
educSome college experience                                                5.046400e-02
educCollege graduate                                                       7.421678e-01
Q21(2) Democrat                                                            2.786460e-03
Q21(3) Independent                                                         8.307615e-37
Q21(4) Other party                                                         5.807672e-88
Q271_reordered(4) Slightly important:S3B(2) Woman                          9.704501e-97
Q271_reordered(3) Moderately important:S3B(2) Woman                        1.561844e-31
Q271_reordered(2) Very important:S3B(2) Woman                             1.350775e-240
Q271_reordered(1) Extremely important:S3B(2) Woman                         4.421798e-01
Q271_reordered(4) Slightly important:S3B(3) Non-binary                     2.853244e-01
Q271_reordered(3) Moderately important:S3B(3) Non-binary                   1.778921e-03
Q271_reordered(2) Very important:S3B(3) Non-binary                         7.113256e-13
Q271_reordered(1) Extremely important:S3B(3) Non-binary                    2.380802e-03
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)       1.121649e-28
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify)     8.791607e-07
Q271_reordered(2) Very important:S3B(4) Something else (Specify)           3.702140e-07
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)      2.124325e-08
(1) Very interested in politics|(2) Somewhat interested                    2.494621e-01
(2) Somewhat interested|(3) Not that interested in politics                4.300465e-01
(3) Not that interested in politics|(4) Not at all interested in politics  1.165368e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(exp_coefs_interact <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR=</span><span class="fu">coef</span>(ord_mod_interactions),<span class="fu">confint</span>(ord_mod_interactions))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                              OR
Q271_reordered(4) Slightly important                                   1.0338781
Q271_reordered(3) Moderately important                                 1.0228231
Q271_reordered(2) Very important                                       0.8366761
Q271_reordered(1) Extremely important                                  0.6069588
S3B(2) Woman                                                           1.5887610
S3B(3) Non-binary                                                      0.5380781
S3B(4) Something else (Specify)                                        0.4648621
race_recodedBlack                                                      1.1525119
race_recodedAsian American                                             1.6819184
race_recodedLatino                                                     1.2583888
race_recodedAIAN                                                       1.4882734
race_recodedNHPI                                                       1.7838764
race_recodedArab/MENA                                                  0.8628526
age_recoded30-39                                                       0.9698580
age_recoded40-49                                                       1.0813779
age_recoded50-59                                                       0.9107924
age_recoded60-69                                                       0.7553567
age_recoded70+                                                         0.5918432
educSome college experience                                            0.6551005
educCollege graduate                                                   0.4476726
Q21(2) Democrat                                                        0.8823547
Q21(3) Independent                                                     1.7222132
Q21(4) Other party                                                     4.7003458
Q271_reordered(4) Slightly important:S3B(2) Woman                      1.0044380
Q271_reordered(3) Moderately important:S3B(2) Woman                    1.0569625
Q271_reordered(2) Very important:S3B(2) Woman                          1.0212671
Q271_reordered(1) Extremely important:S3B(2) Woman                     1.2324558
Q271_reordered(4) Slightly important:S3B(3) Non-binary                 1.5393710
Q271_reordered(3) Moderately important:S3B(3) Non-binary               1.5246008
Q271_reordered(2) Very important:S3B(3) Non-binary                     1.9464262
Q271_reordered(1) Extremely important:S3B(3) Non-binary                1.1408623
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)   4.4125437
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify) 0.5879278
Q271_reordered(2) Very important:S3B(4) Something else (Specify)       9.6145175
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)  1.5327973
                                                                            2.5 %
Q271_reordered(4) Slightly important                                   0.86761871
Q271_reordered(3) Moderately important                                 0.88466618
Q271_reordered(2) Very important                                       0.72314779
Q271_reordered(1) Extremely important                                  0.52449164
S3B(2) Woman                                                           1.36312914
S3B(3) Non-binary                                                      0.28888679
S3B(4) Something else (Specify)                                        0.07401426
race_recodedBlack                                                      1.04988995
race_recodedAsian American                                             1.53325820
race_recodedLatino                                                     1.14546256
race_recodedAIAN                                                       1.27404185
race_recodedNHPI                                                       1.45756175
race_recodedArab/MENA                                                  0.66889425
age_recoded30-39                                                       0.89048308
age_recoded40-49                                                       0.98549367
age_recoded50-59                                                       0.82952560
age_recoded60-69                                                       0.68762045
age_recoded70+                                                         0.52889988
educSome college experience                                            0.60189454
educCollege graduate                                                   0.41528212
Q21(2) Democrat                                                        0.81416780
Q21(3) Independent                                                     1.58330889
Q21(4) Other party                                                     4.03685844
Q271_reordered(4) Slightly important:S3B(2) Woman                      0.78966197
Q271_reordered(3) Moderately important:S3B(2) Woman                    0.87144637
Q271_reordered(2) Very important:S3B(2) Woman                          0.84557349
Q271_reordered(1) Extremely important:S3B(2) Woman                     1.02421823
Q271_reordered(4) Slightly important:S3B(3) Non-binary                 0.46529911
Q271_reordered(3) Moderately important:S3B(3) Non-binary               0.57882727
Q271_reordered(2) Very important:S3B(3) Non-binary                     0.77448045
Q271_reordered(1) Extremely important:S3B(3) Non-binary                0.45797295
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)   0.49596064
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify) 0.05055911
Q271_reordered(2) Very important:S3B(4) Something else (Specify)       0.70357378
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)  0.20059858
                                                                            97.5 %
Q271_reordered(4) Slightly important                                     1.2317529
Q271_reordered(3) Moderately important                                   1.1826555
Q271_reordered(2) Very important                                         0.9680337
Q271_reordered(1) Extremely important                                    0.7024084
S3B(2) Woman                                                             1.8518245
S3B(3) Non-binary                                                        0.9978406
S3B(4) Something else (Specify)                                          2.6422344
race_recodedBlack                                                        1.2652177
race_recodedAsian American                                               1.8451528
race_recodedLatino                                                       1.3825307
race_recodedAIAN                                                         1.7384045
race_recodedNHPI                                                         2.1825886
race_recodedArab/MENA                                                    1.1122887
age_recoded30-39                                                         1.0563119
age_recoded40-49                                                         1.1865407
age_recoded50-59                                                         0.9996833
age_recoded60-69                                                         0.8297158
age_recoded70+                                                           0.6621363
educSome college experience                                              0.7129797
educCollege graduate                                                     0.4825867
Q21(2) Democrat                                                          0.9562372
Q21(3) Independent                                                       1.8733830
Q21(4) Other party                                                       5.4748427
Q271_reordered(4) Slightly important:S3B(2) Woman                        1.2778491
Q271_reordered(3) Moderately important:S3B(2) Woman                      1.2819704
Q271_reordered(2) Very important:S3B(2) Woman                            1.2335590
Q271_reordered(1) Extremely important:S3B(2) Woman                       1.4830676
Q271_reordered(4) Slightly important:S3B(3) Non-binary                   5.0344630
Q271_reordered(3) Moderately important:S3B(3) Non-binary                 4.0084234
Q271_reordered(2) Very important:S3B(3) Non-binary                       4.8746428
Q271_reordered(1) Extremely important:S3B(3) Non-binary                  2.8216144
Q271_reordered(4) Slightly important:S3B(4) Something else (Specify)    41.9119559
Q271_reordered(3) Moderately important:S3B(4) Something else (Specify)   4.9095993
Q271_reordered(2) Very important:S3B(4) Something else (Specify)       160.9916657
Q271_reordered(1) Extremely important:S3B(4) Something else (Specify)   12.5345043</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ord_mod_interactions<span class="sc">$</span>fitted.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (1) Very interested in politics (2) Somewhat interested
1                      0.02661531               0.1489838
2                      0.17064926               0.4451620
3                      0.33294706               0.4624798
4                      0.37955146               0.4470008
5                      0.41022164               0.4339749
6                      0.14354745               0.4227366
  (3) Not that interested in politics (4) Not at all interested in politics
1                           0.2941712                            0.53022976
2                           0.2537623                            0.13042645
3                           0.1463420                            0.05823110
4                           0.1254208                            0.04802698
5                           0.1133179                            0.04248554
6                           0.2782152                            0.15550080</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">predict</span>(ord_mod_interactions))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] (4) Not at all interested in politics (2) Somewhat interested              
[3] (2) Somewhat interested               (2) Somewhat interested              
[5] (2) Somewhat interested               (2) Somewhat interested              
4 Levels: (1) Very interested in politics ... (4) Not at all interested in politics</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(ord_mod_interactions), dataset_clean<span class="sc">$</span>Q29, <span class="at">mode=</span><span class="st">"everything"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

                                       Reference
Prediction                              (1) Very interested in politics
  (1) Very interested in politics                                   650
  (2) Somewhat interested                                          3567
  (3) Not that interested in politics                                57
  (4) Not at all interested in politics                              32
                                       Reference
Prediction                              (2) Somewhat interested
  (1) Very interested in politics                           505
  (2) Somewhat interested                                  6830
  (3) Not that interested in politics                       181
  (4) Not at all interested in politics                      96
                                       Reference
Prediction                              (3) Not that interested in politics
  (1) Very interested in politics                                       120
  (2) Somewhat interested                                              3202
  (3) Not that interested in politics                                   203
  (4) Not at all interested in politics                                 118
                                       Reference
Prediction                              (4) Not at all interested in politics
  (1) Very interested in politics                                          31
  (2) Somewhat interested                                                1550
  (3) Not that interested in politics                                     186
  (4) Not at all interested in politics                                   217

Overall Statistics
                                          
               Accuracy : 0.4503          
                 95% CI : (0.4429, 0.4577)
    No Information Rate : 0.4339          
    P-Value [Acc &gt; NIR] : 6.105e-06       
                                          
                  Kappa : 0.0787          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       

Statistics by Class:

                     Class: (1) Very interested in politics
Sensitivity                                         0.15095
Specificity                                         0.95045
Pos Pred Value                                      0.49770
Neg Pred Value                                      0.77486
Precision                                           0.49770
Recall                                              0.15095
F1                                                  0.23165
Prevalence                                          0.24543
Detection Rate                                      0.03705
Detection Prevalence                                0.07444
Balanced Accuracy                                   0.55070
                     Class: (2) Somewhat interested
Sensitivity                                  0.8973
Specificity                                  0.1625
Pos Pred Value                               0.4509
Neg Pred Value                               0.6736
Precision                                    0.4509
Recall                                       0.8973
F1                                           0.6001
Prevalence                                   0.4339
Detection Rate                               0.3893
Detection Prevalence                         0.8634
Balanced Accuracy                            0.5299
                     Class: (3) Not that interested in politics
Sensitivity                                             0.05572
Specificity                                             0.96950
Pos Pred Value                                          0.32376
Neg Pred Value                                          0.79667
Precision                                               0.32376
Recall                                                  0.05572
F1                                                      0.09508
Prevalence                                              0.20764
Detection Rate                                          0.01157
Detection Prevalence                                    0.03574
Balanced Accuracy                                       0.51261
                     Class: (4) Not at all interested in politics
Sensitivity                                               0.10938
Specificity                                               0.98419
Pos Pred Value                                            0.46868
Neg Pred Value                                            0.89656
Precision                                                 0.46868
Recall                                                    0.10938
F1                                                        0.17736
Prevalence                                                0.11308
Detection Rate                                            0.01237
Detection Prevalence                                      0.02639
Balanced Accuracy                                         0.54678</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate predictions for the ordinal model with interactions</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># new_dataset &lt;- data.frame</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># predict(ord_mod, new_dataset)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fitting-mlr-model" class="level1">
<h1>Fitting MLR Model</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # Load packages</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(nnet)  # for multinomial logistic regression</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tidyverse)</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># library(car)</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(effects)</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # ensure outcome variable is a factor but not ordered</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset_clean$Q29_unordered &lt;- factor(dataset_clean$Q29, ordered = FALSE)</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset_clean$Q271_simple &lt;- as.numeric(dataset_clean$Q271)</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># # Fit multinomial model</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># m_mult &lt;- multinom(Q29_unordered ~ Q271 + race_recoded + age_recoded +</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co">#             # rural + # Rural or Urban/Suburban</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">#             # sex_orientation + # Sexual Orientation</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co">#             educ + # Educational Attainment</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="co">#             S3B + # Gender</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co">#             # S7 + # Nativity</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="co">#             Q21, # Party affiliation</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co">#           data = dataset_clean)</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate predicted probabilities of marginal effects</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create sequence of Q271_simple values</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># x_vals &lt;- seq(min(dataset_clean$Q271_simple), max(dataset_clean$Q271_simple), length.out = 100)</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="co"># # Function to calculate average predicted probabilities</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="co"># get_avg_probs &lt;- function(model, newdata, var_name) {</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="co">#     preds &lt;- predict(model, newdata = newdata, type = "probs")</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="co">#     colMeans(preds)</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate marginal effects by race</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co"># races &lt;- unique(dataset_clean$race_recoded)</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="co"># marg_effects &lt;- list()</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a><span class="co"># for(race in races) {</span></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="co">#     probs &lt;- matrix(0, nrow = length(x_vals), ncol = length(levels(dataset_clean$Q29_unordered)))</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co">#     for(i in seq_along(x_vals)) {</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="co">#         temp_data &lt;- dataset_clean</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="co">#         temp_data$Q271_simple &lt;- x_vals[i]</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="co">#         temp_data$race_major &lt;- race</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="co">#         probs[i,] &lt;- get_avg_probs(m_mult, temp_data, "Q271_simple")</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     marg_effects[[race]] &lt;- data.frame(</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co">#         x = x_vals,</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="co">#         race = race,</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="co">#         prob1 = probs[,1],</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="co">#         prob2 = probs[,2],</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="co">#         prob3 = probs[,3],</span></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="co">#         prob4 = probs[,4]</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     )</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a><span class="co"># # Combine all marginal effects</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a><span class="co"># marg_effects_df &lt;- bind_rows(marg_effects)</span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create plots for marginal effects</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a><span class="co"># # Reshape data for plotting</span></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a><span class="co"># marg_effects_long &lt;- marg_effects_df %&gt;%</span></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="co">#     pivot_longer(cols = starts_with("prob"),</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a><span class="co">#                 names_to = "outcome",</span></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="co">#                 values_to = "probability") %&gt;%</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(outcome = factor(outcome,</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="co">#                           levels = paste0("prob", 1:4),</span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a><span class="co">#                           labels = levels(dataset_clean$Q29_unordered)))</span></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot marginal effects</span></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- ggplot(marg_effects_long, </span></span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="co">#              aes(x = x, y = probability, color = outcome)) +</span></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line() +</span></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a><span class="co">#     facet_wrap(~race) +</span></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_minimal() +</span></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(title = "Marginal Effects of Racial Identity Importance by Race",</span></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="co">#          x = "Importance of Racial Identity",</span></span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a><span class="co">#          y = "Predicted Probability",</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a><span class="co">#          color = "Political Interest Level") +</span></span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.position = "bottom")</span></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="co"># print(p1)</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a><span class="co"># # Model fit statistics and comparisons</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Model summaries:")</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="co"># print(summary(m_mult))</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate McFadden's R-squared</span></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="co"># null_model &lt;- multinom(Q29_unordered ~ 1, data = dataset_clean)</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a><span class="co"># mcfadden_r2 &lt;- 1 - logLik(m_mult)/logLik(null_model)</span></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a><span class="co"># print("McFadden's R-squared:")</span></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="co"># print(mcfadden_r2)</span></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a><span class="co"># # Classification accuracy</span></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_class &lt;- predict(m_mult)</span></span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="co"># conf_matrix &lt;- table(pred_class, dataset_clean$Q29_unordered)</span></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a><span class="co"># accuracy &lt;- sum(diag(conf_matrix))/sum(conf_matrix)</span></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Classification accuracy:")</span></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a><span class="co"># print(accuracy)</span></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Confusion Matrix:")</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="co"># print(conf_matrix)</span></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print AIC</span></span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="co"># print(AIC(m_mult))</span></span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate predicted probabilities</span></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_data &lt;- expand.grid(</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a><span class="co">#     Q271 = unique(dataset_clean$Q271),</span></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a><span class="co">#     age_recoded = unique(dataset_clean$age_recoded),</span></span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a><span class="co">#     race_recoded = unique(dataset_clean$race_recoded),</span></span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a><span class="co">#     educ = unique(dataset_clean$educ),</span></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="co">#     S3B = unique(dataset_clean$S3B),</span></span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a><span class="co">#     Q21 = unique(dataset_clean$Q21)</span></span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a><span class="co"># # Get predictions</span></span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m_mult, newdata = pred_data, type = "probs")</span></span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_data &lt;- cbind(pred_data, as.data.frame(preds))</span></span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create separate plots for each outcome level</span></span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_long &lt;- pred_data %&gt;%</span></span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a><span class="co">#     pivot_longer(cols = starts_with("("),</span></span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a><span class="co">#                 names_to = "interest_level",</span></span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a><span class="co">#                 values_to = "probability")</span></span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot for each outcome level</span></span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;- ggplot(pred_long, </span></span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a><span class="co">#              aes(x = Q271, y = probability, color = race_recoded)) +</span></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a><span class="co">#     geom_line() +</span></span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a><span class="co">#     facet_wrap(~interest_level) +</span></span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme_minimal() +</span></span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a><span class="co">#     labs(title = "Predicted Probabilities by Outcome Level",</span></span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a><span class="co">#          x = "Importance of Racial Identity",</span></span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a><span class="co">#          y = "Probability",</span></span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a><span class="co">#          color = "Race/Ethnicity") +</span></span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a><span class="co">#     theme(legend.position = "bottom")</span></span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a><span class="co"># print(p2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
</section>
</section>
<section id="fitting-olr-model-using-clm-following-jennifers-method" class="level1">
<h1>Fitting OLR Model Using clm() (Following Jennifer’s method)</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset_clean$Q271_simple &lt;- as.numeric(dataset_clean$Q271)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # dataset_clean$Q271 &lt;- factor(dataset_clean$Q271,</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #                             levels = c("(5) Not at all important",</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #                                      "(4) Slightly important",</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># #                                      "(3) Moderately important",</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># #                                      "(2) Very important",</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># #                                      "(1) Extremely important"),</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># #                             ordered = TRUE)</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="co"># m1 &lt;- clm(Q29 ~ Q271 + race_recoded + age_recoded +</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">#             rural + # Rural or Urban/Suburban</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="co">#             sex_orientation + # Sexual Orientation</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="co">#             Religion + </span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">#             educ + # Educational Attainment</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co">#             S3B + # Gender</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="co">#             S7 + # Nativity</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="co">#             Q21, # Party affiliation</span></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="co">#           data = dataset_clean)</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(m1)</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a><span class="co"># # Check for multicollinearity using a linear approximation</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a><span class="co"># vif_m1 &lt;- vif(lm(as.numeric(Q29) ~ Q271 + race_recoded + age_recoded +</span></span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a><span class="co">#             rural + # Rural or Urban/Suburban</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a><span class="co">#             sex_orientation + # Sexual Orientation</span></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a><span class="co">#             Religion + </span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a><span class="co">#             educ + # Educational Attainment</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a><span class="co">#             S3B + # Gender</span></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co">#             S7 + # Nativity</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a><span class="co">#             Q21, # Party affiliation</span></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a><span class="co">#           data = dataset_clean))</span></span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Variance Inflation Factors:")</span></span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a><span class="co"># print(vif_m1)</span></span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="co"># # Test proportional odds assumption</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Testing proportional odds assumption:")</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a><span class="co"># test1 &lt;- nominal_test(m1)</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Nominal test for Model 1:")</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a><span class="co"># print(test1)</span></span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a><span class="co"># # Alternative diagnostic approach using linear approximation</span></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co"># lm_approx &lt;- lm(as.numeric(Q29) ~ Q271 + race_recoded + age_recoded +</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a><span class="co">#             rural + # Rural or Urban/Suburban</span></span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a><span class="co">#             sex_orientation + # Sexual Orientation</span></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="co">#             Religion + </span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a><span class="co">#             educ + # Educational Attainment</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a><span class="co">#             S3B + # Gender</span></span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a><span class="co">#             S7 + # Nativity</span></span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a><span class="co">#             Q21, # Party affiliation</span></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="co">#           data = dataset_clean)</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="co"># diagnostics_df &lt;- data.frame(</span></span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a><span class="co">#   fitted = fitted(lm_approx),</span></span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   residuals = residuals(lm_approx),</span></span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a><span class="co">#   index = 1:nrow(dataset_clean)</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot residuals vs fitted values using linear approximation</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a><span class="co"># p1 &lt;- ggplot(diagnostics_df, aes(x = fitted, y = residuals)) +</span></span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(alpha = 0.1) +</span></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_smooth(method = "loess") +</span></span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Residuals vs Fitted Values (Linear Approximation)",</span></span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Fitted Values",</span></span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Residuals")</span></span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a><span class="co"># print(p1)</span></span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate and plot Cook's distance</span></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a><span class="co"># cooks_d &lt;- cooks.distance(lm_approx)</span></span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a><span class="co"># influence_df &lt;- data.frame(</span></span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a><span class="co">#   index = 1:length(cooks_d),</span></span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a><span class="co">#   cooks_distance = cooks_d</span></span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a><span class="co"># p2 &lt;- ggplot(influence_df, aes(x = index, y = cooks_distance)) +</span></span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point() +</span></span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_hline(yintercept = 4/nrow(dataset_clean), color = "red", linetype = "dashed") +</span></span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Cook's Distance Plot",</span></span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Observation Number",</span></span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Cook's Distance")</span></span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a><span class="co"># print(p2)</span></span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a><span class="co"># # Count influential observations</span></span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a><span class="co"># influential_obs &lt;- which(cooks_d &gt; 4/nrow(dataset_clean))</span></span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Number of influential observations:")</span></span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a><span class="co"># print(length(influential_obs))</span></span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create prediction visualization</span></span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_data &lt;- expand.grid(</span></span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a><span class="co">#   Q271 = levels(dataset_clean$Q271),</span></span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a><span class="co">#   race_recoded = levels(dataset_clean$race_recoded), </span></span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a><span class="co">#   age_recoded = levels(dataset_clean$age_recoded),</span></span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a><span class="co">#   rural = levels(dataset_clean$rural),</span></span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a><span class="co">#   sex_orientation = levels(dataset_clean$sex_orientation),</span></span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a><span class="co">#   Religion = levels(dataset_clean$Religion),</span></span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a><span class="co">#   educ = levels(dataset_clean$educ),</span></span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a><span class="co">#   S3B = levels(dataset_clean$S3B),</span></span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a><span class="co">#   S7 = levels(dataset_clean$S7),</span></span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a><span class="co">#   Q21 = levels(dataset_clean$Q21)</span></span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a><span class="co"># # Get predicted probabilities</span></span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a><span class="co"># preds &lt;- predict(m1, newdata = pred_data, type = "prob")</span></span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a><span class="co"># # Convert predictions to numeric scores (weighted average)</span></span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_data$predicted_score &lt;- apply(preds$fit, 1, function(x) sum(x * 1:4))</span></span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a><span class="co"># # Create prediction plot</span></span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a><span class="co"># p3 &lt;- ggplot(pred_data, aes(x = Q271, y = predicted_score, color = race_recoded)) +</span></span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point() +</span></span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(aes(group = race_recoded)) +</span></span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal() +</span></span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 45, hjust = 1)) +</span></span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(title = "Predicted Political Interest by Racial Identity Importance and Race",</span></span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a><span class="co">#        x = "Importance of Racial Identity",</span></span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a><span class="co">#        y = "Predicted Political Interest Level (1-4)",</span></span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a><span class="co">#        color = "Race/Ethnicity")</span></span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a><span class="co"># print(p3)</span></span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a><span class="co"># # Print the coefficients table</span></span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Coefficients for Model 1:")</span></span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a><span class="co"># coef_table &lt;- summary(m1)$coefficients</span></span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a><span class="co"># print(coef_table)</span></span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-127"><a href="#cb46-127" aria-hidden="true" tabindex="-1"></a><span class="co"># # Calculate and print odds ratios for the coefficients</span></span>
<span id="cb46-128"><a href="#cb46-128" aria-hidden="true" tabindex="-1"></a><span class="co"># odds_ratios &lt;- exp(coef_table[, "Estimate"])</span></span>
<span id="cb46-129"><a href="#cb46-129" aria-hidden="true" tabindex="-1"></a><span class="co"># print("Odds Ratios:")</span></span>
<span id="cb46-130"><a href="#cb46-130" aria-hidden="true" tabindex="-1"></a><span class="co"># print(odds_ratios)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="interpretation-1" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-1">Interpretation</h2>
<ol type="1">
<li>Model Fit:
<ol type="1">
<li>AIC is 42342.54</li>
<li>Log-likelihood is -21125.27</li>
</ol></li>
<li>Proportional Odds Assumption</li>
</ol>
<ul>
<li><p>The nominal test for Model 1 shows significant violations (p &lt; 0.05 for all predictor variables except for Religion)</p></li>
<li><p>This suggests the effect of racial identity importance varies across different levels of political interest</p></li>
</ul>
<ol type="1">
<li>Multicollinearity</li>
</ol>
<ul>
<li>Interpretation of VIF values</li>
</ul>
<ol type="1">
<li>Residuals and Model Diagnostics</li>
</ol>
<ul>
<li><p>The residuals plot shows:</p>
<ul>
<li><p>A relatively flat line around zero</p></li>
<li><p>Straight downward slope patterns in the residuals</p></li>
</ul></li>
</ul>
<ol type="1">
<li>Influential Points:
<ul>
<li><p>There are 804 influential observations.</p></li>
<li><p>Cook’s distance plot shows multiple observations above the threshold.</p></li>
<li><p>Given the large sample size (17,545), this number of influential points is not extremely concerning.</p></li>
</ul></li>
<li>Key Findings from Model 1:
<ol type="1">
<li>The different levels of racial identity importance are all significant</li>
<li>There are differences among racial/ethnic groups</li>
</ol></li>
<li>Predicted Relationships (from plot)
<ol type="1">
<li></li>
</ol></li>
</ol>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>