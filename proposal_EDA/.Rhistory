ggplot(wtd_tableQ29, aes(x=Q29, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
table(data$Race_Ethnicity)
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(aes(label = scales::percent(..count../sum(..count..))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
wtd_tableQ29 <- data %>% count(Q29, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(aes(label = scales::percent(..count../sum(..count..))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
View(wtd_tableQ29)
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(aes(label = scales::percent(..count../sum(..count..))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(aes(label = scales::percent(after_stat(count)/sum(after_stat(count)))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(aes(label = scales::percent(after_stat(count)/sum(after_stat(count), accuracy=1))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(aes(label = scales::percent(after_stat(count)/sum(after_stat(count)))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
theme_minimal() +
geom_text(aes(label = scales::percent(after_stat(count)/sum(after_stat(count)))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
library(tidyverse)
library(ggplot2)
library(formattable)
library(scales)
rm(list=ls())
load("/Users/pdeguz01/Documents/git/Data/2020 CMPS/DS0001/39096-0001-Data.rda")
data <- da39096.0001
reordered_data <- data %>% relocate(Q29, Q271, WEIGHT,
AGE1_HID, AGE2_HID, .after = DATE)
reordered_data %>% slice_head(n = 50) %>% str()
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal() +
geom_text(aes(label = scales::percent(after_stat(count)/sum(after_stat(count)))),
stat = "count",
position = position_fill(vjust = 0.5),
color = "white")
data <- data %>% mutate(Q29_shortened = case_when(Q29 == "(1) Very interested in politics" ~ "Very interested",
Q29 == "(2) Somewhat interested" ~ "Somewhat interested",
Q29 == "(3) Not that interested in politics" ~ "Not that interested",
Q29 == "(4) Not at all interested in politics" ~ "Not at all interested",
.default = "Other"))
wtd_tableQ29 <- data %>% count(Q29_shortened, wt=WEIGHT)
wtd_tableQ29 <- wtd_tableQ29 %>% mutate('pct' = (n/sum(n, na.rm=TRUE)))
ggplot(wtd_tableQ29, aes(x=Q29_shortened, y = pct)) +
geom_bar(stat="identity", fill = "orange") +
geom_text(aes(label=percent(pct)), vjust=1.6, color="white", size =3.5) +
labs(title = "Reported Interest in Politics",
x = "Level of Interest", y = "Percent (Weighted)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5))
contingency_table <- table(data$Q29_shortened, data$Q271)
contingency_df <- as.data.frame(contingency_table)
contingency_df <- contingency_df %>% mutate(Share = (Freq/sum(Freq)))
ggplot(contingency_df, aes(x = Var1, y = Var2, fill = Share)) +
geom_tile() +
labs(title="Interest in Politics and Racial Identity", x = "Interest in Politics", y = "Importance of Racial Identity") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 0.4, vjust = 0.5)) +
scale_fill_continuous(low = "white", high = "blue", labels = percent_format(scale = 100))
data$Q1R5_cleaned <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$Q1R5))
data$Q1R5_cleaned <- factor(data$Q1R5_cleaned, levels = c(0, 1), labels = c("Not Important", "Important"))
# Plot the distribution of Q1R5
ggplot(data, aes(x = Q1R5_cleaned)) +
geom_bar(fill = "skyblue") +
labs(title = "Importance of Stopping Discrimination Against Racial/Ethnic Minorities",
x = "Importance Level",
y = "Count") +
theme_minimal()
data$MAIN_ETH_QUOTA_numeric <- as.numeric(sub("^\\((\\d+)\\).*", "\\1", data$MAIN_ETH_QUOTA))
data$Race_Ethnicity <- factor(data$MAIN_ETH_QUOTA_numeric,
levels = 1:7,
labels = c("White", "Latino", "Black", "AAPI", "ANAI", "MENA", "NH"))
# Plot with short-term race labels on the x-axis and percentage labels on the bars
ggplot(data, aes(x = Race_Ethnicity, fill = Q1R5_cleaned)) +
geom_bar(position = "fill") +
labs(title = "Importance of Stopping Discrimination by Race/Ethnicity",
x = "Race/Ethnicity",
y = "Proportion",
fill = "Importance Level",
caption = "Race/Ethnicity Abbreviations: ANAI = Native American, NH = Native Hawaiian, AAPI = Asian American/Pacific Islander, MENA = Middle Eastern/North African") +
scale_y_continuous(labels = scales::percent) +
theme_minimal()
